<!doctype html><html lang=zh class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="hackettyu's blog | hackettyu.repeat( me.eat().sleep().code() )"><meta name=author content=hackettyu><link href=https://hackettyu.com/latest/docs/digest/1809270x02/ rel=canonical><link rel=icon href=../../../assets/images/favicon.png><meta name=generator content="mkdocs-1.2.1, mkdocs-material-7.1.11"><title>1809270x02 - hackettyu's blog</title><link rel=stylesheet href=../../../assets/stylesheets/main.3754935a.min.css><link rel=stylesheet href=../../../assets/stylesheets/palette.f1a3b89f.min.css><meta name=theme-color content=#ffffff><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Noto+Sans+SC:300,400,400i,700%7CFira+Code&display=fallback"><style>:root{--md-text-font-family:"Noto Sans SC";--md-code-font-family:"Fira Code"}</style><link rel=stylesheet href=/css/termynal.css><link rel=stylesheet href=/css/custom.css><script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-146236033-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){var e;this.value&&(e=document.location.pathname,ga("send","pageview",e+"?q="+this.value))}),"undefined"!=typeof location$&&location$.subscribe(function(e){ga("send","pageview",e.pathname)})})</script><script async src=https://www.google-analytics.com/analytics.js></script></head> <body dir=ltr data-md-color-scheme=preference data-md-color-primary=white data-md-color-accent=indigo> <script>function __prefix(e){return new URL("../../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#_1 class=md-skip> 跳转至 </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../.. title="hackettyu's blog" class="md-header__button md-logo" aria-label="hackettyu's blog" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 89 89"> <path d=M3.136,17.387l0,42.932l42.932,21.467l-42.932,-64.399Z /> <path d=M21.91,8l42.933,64.398l-18.775,9.388l-42.932,-64.399l18.774,-9.387Z style="fill-opacity: 0.5"/> <path d=M67.535,17.387l-27.262,18.156l21.878,32.818l5.384,2.691l0,-53.665Z /> <path d=M67.535,17.387l0,53.666l18.774,-9.388l0,-53.665l-18.774,9.387Z style="fill-opacity: 0.25"/> </svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> hackettyu's blog </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> 1809270x02 </span> </div> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=搜索 placeholder=搜索 autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query data-md-state=active required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </label> <button type=reset class="md-search__icon md-icon" aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg> </button> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> 正在初始化搜索引擎 </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/hackettyu/hackettyu-mkdocs-material/ title="前往 GitHub 仓库" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> hackettyu/hackettyu-mkdocs-material </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../../2018-12-15-switch-eclipse-version/ class=md-tabs__link> 2018 </a> </li> <li class=md-tabs__item> <a href=../../../2019-02-16-javascript-error-msg/ class=md-tabs__link> 2019 </a> </li> <li class=md-tabs__item> <a href=../../../2020-09-14-awosome-command-line-slide/ class=md-tabs__link> 2020 </a> </li> <li class=md-tabs__item> <a href=../../../2021-02-02-abap-rest-use-library/ class=md-tabs__link> 2021 </a> </li> <li class=md-tabs__item> <a href=../../archives/ABAP-guide-zh/ class="md-tabs__link md-tabs__link--active"> docs </a> </li> <li class=md-tabs__item> <a href=../../../cheatsheet/ class=md-tabs__link> about </a> </li> <li class=md-tabs__item> <a href=../../../weekly/weekly-2021-04-0x01/ class=md-tabs__link> weekly </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../.. title="hackettyu's blog" class="md-nav__button md-logo" aria-label="hackettyu's blog" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 89 89"> <path d=M3.136,17.387l0,42.932l42.932,21.467l-42.932,-64.399Z /> <path d=M21.91,8l42.933,64.398l-18.775,9.388l-42.932,-64.399l18.774,-9.387Z style="fill-opacity: 0.5"/> <path d=M67.535,17.387l-27.262,18.156l21.878,32.818l5.384,2.691l0,-53.665Z /> <path d=M67.535,17.387l0,53.666l18.774,-9.388l0,-53.665l-18.774,9.387Z style="fill-opacity: 0.25"/> </svg> </a> hackettyu's blog </label> <div class=md-nav__source> <a href=https://github.com/hackettyu/hackettyu-mkdocs-material/ title="前往 GitHub 仓库" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> hackettyu/hackettyu-mkdocs-material </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_1 data-md-state=indeterminate type=checkbox id=__nav_1 checked> <label class=md-nav__link for=__nav_1> 2018 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=2018 data-md-level=1> <label class=md-nav__title for=__nav_1> <span class="md-nav__icon md-icon"></span> 2018 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../2018-12-15-switch-eclipse-version/ class=md-nav__link> Eclipse 下切换编译 Java 版本 </a> </li> <li class=md-nav__item> <a href=../../../2018-11-13-ssh-login/ class=md-nav__link> SSH 登录时出现如下错误：Disconnected:No supported authentication methods available 问题处理 </a> </li> <li class=md-nav__item> <a href=../../../2018-12-02-windows-git-bash/ class=md-nav__link> Windows 下使用 git bash 自带的功能配置终端主题 </a> </li> <li class=md-nav__item> <a href=../../../2018-10-25-hexo-dns/ class=md-nav__link> hexo 配置 DNS 分流导致国内找不到 HOST 的问题处理 </a> </li> <li class=md-nav__item> <a href=../../../2018-10-25-firewall-cmd/ class=md-nav__link> 关于 CentOS 7 新的防火墙命令 firewall-cmd </a> </li> <li class=md-nav__item> <a href=../../../2018-10-04-powershell-upper/ class=md-nav__link> 在命令行下使用 Powershell 提权 </a> </li> <li class=md-nav__item> <a href=../../../2018-10-18-java-swap-function/ class=md-nav__link> 我在写 java swap 函数时理解了值传递与引用 </a> </li> <li class=md-nav__item> <a href=../../../2018-10-06-linux-ln/ class=md-nav__link> 用 ln 命令了解硬链接和软连接 </a> </li> <li class=md-nav__item> <a href=../../../2018-10-04-command-close-nvida/ class=md-nav__link> 用命令行操作 Window 系统的显卡驱动程序 </a> </li> <li class=md-nav__item> <a href=../../../2018-09-27-code-cloc/ class=md-nav__link> 用量化自己的代码生涯：用命令行工具 cloc 做代码行统计 </a> </li> <li class=md-nav__item> <a href=../../../2018-10-01-chromium-google-api/ class=md-nav__link> 解决 Chromium 浏览器缺少 Google API 密钥无法登录问题 </a> </li> <li class=md-nav__item> <a href=../../../2018-09-13-ubuntu-board/ class=md-nav__link> 解决 Ubuntu v16.04 没有在打字时停用触摸板选项 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2 data-md-state=indeterminate type=checkbox id=__nav_2 checked> <label class=md-nav__link for=__nav_2> 2019 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=2019 data-md-level=1> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> 2019 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../2019-02-16-javascript-error-msg/ class=md-nav__link> JavaScript 错误参考（转载） </a> </li> <li class=md-nav__item> <a href=../../../2019-01-02-javascript-use/ class=md-nav__link> 关于 JavaScript 作用域问题 </a> </li> <li class=md-nav__item> <a href=../../../2019-04-14-tomcat-deploy-web/ class=md-nav__link> 利用 Tomcat8 和 maven 部署 Web 工程 </a> </li> <li class=md-nav__item> <a href=../../../2019-09-16-chrome-extention/ class=md-nav__link> 利用 policy whitelist 解决 Chrome 第三方扩展安装的问题 </a> </li> <li class=md-nav__item> <a href=../../../2019-11-04-hexo-kindle/ class=md-nav__link> 如何将 hexo 的 blog 页面发送到 kindle </a> </li> <li class=md-nav__item> <a href=../../../2019-04-13-spring-framework-version/ class=md-nav__link> 如何订阅一个 Repo 的 Realese 信息：利用 Github API 获取 spring-framework 所有版本更新信息 </a> </li> <li class=md-nav__item> <a href=../../../2019-10-30-hexo-ogp/ class=md-nav__link> 给 hexo 博客添加 OGP 协议支持 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3 data-md-state=indeterminate type=checkbox id=__nav_3 checked> <label class=md-nav__link for=__nav_3> 2020 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=2020 data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> 2020 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../2020-09-14-awosome-command-line-slide/ class=md-nav__link> Awesome command line slide | 记一次分享命令行的幻灯片 </a> </li> <li class=md-nav__item> <a href=../../../2020-09-09-lightproxy-unofficial-document/ class=md-nav__link> LightPorxy 的非官方文档 </a> </li> <li class=md-nav__item> <a href=../../../2020-06-17-mkdocs-material-turtorial/ class=md-nav__link> Mkdocs 搭建博客指北，以及推荐 mkdocs-materials 主题 </a> </li> <li class=md-nav__item> <a href=../../../2020-11-04-sap-mdg-api-example/ class=md-nav__link> SAP 主数据参考 ｜ SAP MDG API examples </a> </li> <li class=md-nav__item> <a href=../../../2020-05-07-windows-scoop/ class=md-nav__link> Windows 下使用 Scoop 工具安装环境以及管理各种软件 </a> </li> <li class=md-nav__item> <a href=../../../2020-08-20-ABAP-code-indent/ class=md-nav__link> 关于 ABAP 的代码缩进风格的思考 </a> </li> <li class=md-nav__item> <a href=../../../2020-03-20-vscode-diff/ class=md-nav__link> 命令行下切换当前 workplace 到 Visual Studio Code </a> </li> <li class=md-nav__item> <a href=../../../2020-11-02-python-enum/ class=md-nav__link> 简单使用一下 Python enum </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4 data-md-state=indeterminate type=checkbox id=__nav_4 checked> <label class=md-nav__link for=__nav_4> 2021 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=2021 data-md-level=1> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> 2021 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../2021-02-02-abap-rest-use-library/ class=md-nav__link> ABAP REST 工具库 CL_REST_LIBRARY ｜ ABAP 使用 CL_REST_LIBRARY 实现 RESTful 接口 </a> </li> <li class=md-nav__item> <a href=../../../2021-06-08-ABAP-WTF/ class=md-nav__link> ABAP WTF 时刻 </a> </li> <li class=md-nav__item> <a href=../../../2021-01-25-abap-rest-interface/ class=md-nav__link> ABAP 创建一个简单的 RESTful 接口 </a> </li> <li class=md-nav__item> <a href=../../../2021-06-21-github-pr-workflow/ class=md-nav__link> Github PR workflow </a> </li> <li class=md-nav__item> <a href=../../../2021-03-31-SAP-JCo-example/ class=md-nav__link> SAP JCo 例子 | SAP Java Connector 参考 </a> </li> <li class=md-nav__item> <a href=../../../2021-06-25-abap-dont-need-many-loops/ class=md-nav__link> 关于 ABAP 或许不需要那么多的循环 </a> </li> <li class=md-nav__item> <a href=../../../2021-02-08-bullet-journal-tuturial/ class=md-nav__link> 写给程序员的子弹笔记指南 ｜ Bullet journal guide for the programmer </a> </li> <li class=md-nav__item> <a href=../../../2021-02-01-zeep-turtorial/ class=md-nav__link> 用 Python 的 SOAP client Zeep 解析 Webservice 接口 </a> </li> <li class=md-nav__item> <a href=../../../2021-02-03-mkdocs-add-termy/ class=md-nav__link> 让博客里的 Terminal 的例子动起来，给 Mkdocs 添加 termynal 支持 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5 type=checkbox id=__nav_5 checked> <label class=md-nav__link for=__nav_5> docs <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=docs data-md-level=1> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> docs </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5_1 data-md-state=indeterminate type=checkbox id=__nav_5_1 checked> <label class=md-nav__link for=__nav_5_1> others <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=others data-md-level=2> <label class=md-nav__title for=__nav_5_1> <span class="md-nav__icon md-icon"></span> others </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../archives/ABAP-guide-zh/ class=md-nav__link> archives-ABAP-guide-zh </a> </li> <li class=md-nav__item> <a href=../../backup/171216/ class=md-nav__link> backup-171216 </a> </li> <li class=md-nav__item> <a href=../../backup/171231/ class=md-nav__link> backup-171231 </a> </li> <li class=md-nav__item> <a href=../../backup/180102/ class=md-nav__link> backup-180102 </a> </li> <li class=md-nav__item> <a href=../../backup/180103/ class=md-nav__link> backup-180103 </a> </li> <li class=md-nav__item> <a href=../../backup/180510/ class=md-nav__link> backup-180510 </a> </li> <li class=md-nav__item> <a href=../../backup/180915/ class=md-nav__link> backup-180915 </a> </li> <li class=md-nav__item> <a href=../../log/firefox-addon/ class=md-nav__link> docs-log-firefox-addon </a> </li> <li class=md-nav__item> <a href=../../log/fix-bugs/ class=md-nav__link> docs-log-fix-bugs </a> </li> <li class=md-nav__item> <a href=../../note/ISO-8601/ class=md-nav__link> docs-note-ISO-8601 </a> </li> <li class=md-nav__item> <a href=../../note/code-pushdown/ class=md-nav__link> docs-note-code-pushdown </a> </li> <li class=md-nav__item> <a href=../../note/code-smell/ class=md-nav__link> docs-note-code-smell </a> </li> <li class=md-nav__item> <a href=../../note/json-styleguide-note/ class=md-nav__link> docs-note-json-styleguide-note </a> </li> <li class=md-nav__item> <a href=../../note/my-todoist/ class=md-nav__link> docs-note-my-todoist </a> </li> <li class=md-nav__item> <a href=../../note/one-python-craftsman-note/ class=md-nav__link> docs-note-one-python-craftsman-note </a> </li> <li class=md-nav__item> <a href=../../note/ubuntu/ class=md-nav__link> docs-note-ubuntu </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5_2 data-md-state=indeterminate type=checkbox id=__nav_5_2 checked> <label class=md-nav__link for=__nav_5_2> books <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=books data-md-level=2> <label class=md-nav__title for=__nav_5_2> <span class="md-nav__icon md-icon"></span> books </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../books/ISBN-9787115249494/ class=md-nav__link> ISBN-9787115249494 </a> </li> <li class=md-nav__item> <a href=../../books/ISBN-9787521705041/ class=md-nav__link> ISBN-9787521705041 </a> </li> <li class=md-nav__item> <a href=../../books/ISBN-9787553678054/ class=md-nav__link> ISBN-9787553678054 </a> </li> <li class=md-nav__item> <a href=../../books/ISBN-9787559627636/ class=md-nav__link> ISBN-9787559627636 </a> </li> <li class=md-nav__item> <a href=../../books/ISBN-9787559632265/ class=md-nav__link> ISBN-9787559632265 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5_3 data-md-state=indeterminate type=checkbox id=__nav_5_3 checked> <label class=md-nav__link for=__nav_5_3> command <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=command data-md-level=2> <label class=md-nav__title for=__nav_5_3> <span class="md-nav__icon md-icon"></span> command </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../command/bash-cheatsheet/ class=md-nav__link> bash-cheatsheet </a> </li> <li class=md-nav__item> <a href=../../command/cmd/about-wifi/ class=md-nav__link> cmd-about-wifi </a> </li> <li class=md-nav__item> <a href=../../command/cmd/chcp/ class=md-nav__link> cmd-chcp </a> </li> <li class=md-nav__item> <a href=../../command/cmd/clip/ class=md-nav__link> cmd-clip </a> </li> <li class=md-nav__item> <a href=../../command/cmd/gcc/ class=md-nav__link> cmd-gcc </a> </li> <li class=md-nav__item> <a href=../../command/cmd/javap/ class=md-nav__link> cmd-javap </a> </li> <li class=md-nav__item> <a href=../../command/cmd/netstat/ class=md-nav__link> cmd-netstat </a> </li> <li class=md-nav__item> <a href=../../command/cmd/ping/ class=md-nav__link> cmd-ping </a> </li> <li class=md-nav__item> <a href=../../command/cmd/set/ class=md-nav__link> cmd-set </a> </li> <li class=md-nav__item> <a href=../../command/cmd/shutdown/ class=md-nav__link> cmd-shutdown </a> </li> <li class=md-nav__item> <a href=../../command/cmd/taskkill/ class=md-nav__link> cmd-taskkill </a> </li> <li class=md-nav__item> <a href=../../command/cmd/wireshark/ class=md-nav__link> cmd-wireshark </a> </li> <li class=md-nav__item> <a href=../../command/cmd/wmic/ class=md-nav__link> cmd-wmic </a> </li> <li class=md-nav__item> <a href=../../command/cmd/wsl/ class=md-nav__link> cmd-wsl </a> </li> <li class=md-nav__item> <a href=../../command/funny/ class=md-nav__link> funny </a> </li> <li class=md-nav__item> <a href=../../command/linux/cat/ class=md-nav__link> linux-cat </a> </li> <li class=md-nav__item> <a href=../../command/linux/column/ class=md-nav__link> linux-column </a> </li> <li class=md-nav__item> <a href=../../command/linux/csplit/ class=md-nav__link> linux-csplit </a> </li> <li class=md-nav__item> <a href=../../command/linux/dd/ class=md-nav__link> linux-dd </a> </li> <li class=md-nav__item> <a href=../../command/linux/df/ class=md-nav__link> linux-df </a> </li> <li class=md-nav__item> <a href=../../command/linux/dpkg/ class=md-nav__link> linux-dpkg </a> </li> <li class=md-nav__item> <a href=../../command/linux/ethtool/ class=md-nav__link> linux-ethtool </a> </li> <li class=md-nav__item> <a href=../../command/linux/find/ class=md-nav__link> linux-find </a> </li> <li class=md-nav__item> <a href=../../command/linux/git/ class=md-nav__link> linux-git </a> </li> <li class=md-nav__item> <a href=../../command/linux/grep/ class=md-nav__link> linux-grep </a> </li> <li class=md-nav__item> <a href=../../command/linux/history/ class=md-nav__link> linux-history </a> </li> <li class=md-nav__item> <a href=../../command/linux/ifconfig/ class=md-nav__link> linux-ifconfig </a> </li> <li class=md-nav__item> <a href=../../command/linux/last/ class=md-nav__link> linux-last </a> </li> <li class=md-nav__item> <a href=../../command/linux/lsof/ class=md-nav__link> linux-lsof </a> </li> <li class=md-nav__item> <a href=../../command/linux/mmv/ class=md-nav__link> linux-mmv </a> </li> <li class=md-nav__item> <a href=../../command/linux/mv/ class=md-nav__link> linux-mv </a> </li> <li class=md-nav__item> <a href=../../command/linux/scp/ class=md-nav__link> linux-scp </a> </li> <li class=md-nav__item> <a href=../../command/linux/service/ class=md-nav__link> linux-service </a> </li> <li class=md-nav__item> <a href=../../command/linux/shred/ class=md-nav__link> linux-shred </a> </li> <li class=md-nav__item> <a href=../../command/linux/split/ class=md-nav__link> linux-split </a> </li> <li class=md-nav__item> <a href=../../command/linux/tail/ class=md-nav__link> linux-tail </a> </li> <li class=md-nav__item> <a href=../../command/linux/top/ class=md-nav__link> linux-top </a> </li> <li class=md-nav__item> <a href=../../command/linux/w/ class=md-nav__link> linux-w </a> </li> <li class=md-nav__item> <a href=../../command/linux/watch/ class=md-nav__link> linux-watch </a> </li> <li class=md-nav__item> <a href=../../command/linux/wget/ class=md-nav__link> linux-wget </a> </li> <li class=md-nav__item> <a href=../../command/service/docker/ class=md-nav__link> service-docker </a> </li> <li class=md-nav__item> <a href=../../command/service/github/ class=md-nav__link> service-github </a> </li> <li class=md-nav__item> <a href=../../command/service/hexo/ class=md-nav__link> service-hexo </a> </li> <li class=md-nav__item> <a href=../../command/service/mysql/ class=md-nav__link> service-mysql </a> </li> <li class=md-nav__item> <a href=../../command/service/rsshub/ class=md-nav__link> service-rsshub </a> </li> <li class=md-nav__item> <a href=../../command/service/sycnthing/ class=md-nav__link> service-sycnthing </a> </li> <li class=md-nav__item> <a href=../../command/service/ttrss/ class=md-nav__link> service-ttrss </a> </li> <li class=md-nav__item> <a href=../../command/tools/ class=md-nav__link> tools-README </a> </li> <li class=md-nav__item> <a href=../../command/tools/ag/ class=md-nav__link> tools-ag </a> </li> <li class=md-nav__item> <a href=../../command/tools/aria2/ class=md-nav__link> tools-aria2 </a> </li> <li class=md-nav__item> <a href=../../command/tools/asciinema/ class=md-nav__link> tools-asciinema </a> </li> <li class=md-nav__item> <a href=../../command/tools/book/ class=md-nav__link> tools-book </a> </li> <li class=md-nav__item> <a href=../../command/tools/bypy/ class=md-nav__link> tools-bypy </a> </li> <li class=md-nav__item> <a href=../../command/tools/code/ class=md-nav__link> tools-code </a> </li> <li class=md-nav__item> <a href=../../command/tools/curl/ class=md-nav__link> tools-curl </a> </li> <li class=md-nav__item> <a href=../../command/tools/diff2html/ class=md-nav__link> tools-diff2html </a> </li> <li class=md-nav__item> <a href=../../command/tools/docker/ class=md-nav__link> tools-docker </a> </li> <li class=md-nav__item> <a href=../../command/tools/fail2ban/ class=md-nav__link> tools-fail2ban </a> </li> <li class=md-nav__item> <a href=../../command/tools/fd/ class=md-nav__link> tools-fd </a> </li> <li class=md-nav__item> <a href=../../command/tools/ffmepg/ class=md-nav__link> tools-ffmepg </a> </li> <li class=md-nav__item> <a href=../../command/tools/jq/ class=md-nav__link> tools-jq </a> </li> <li class=md-nav__item> <a href=../../command/tools/mvn/ class=md-nav__link> tools-mvn </a> </li> <li class=md-nav__item> <a href=../../command/tools/nativefier/ class=md-nav__link> tools-nativefier </a> </li> <li class=md-nav__item> <a href=../../command/tools/networksetup/ class=md-nav__link> tools-networksetup </a> </li> <li class=md-nav__item> <a href=../../command/tools/npm/ class=md-nav__link> tools-npm </a> </li> <li class=md-nav__item> <a href=../../command/tools/ossutil/ class=md-nav__link> tools-ossutil </a> </li> <li class=md-nav__item> <a href=../../command/tools/pandoc/ class=md-nav__link> tools-pandoc </a> </li> <li class=md-nav__item> <a href=../../command/tools/pdfminer.six/ class=md-nav__link> tools-pdfminer.six </a> </li> <li class=md-nav__item> <a href=../../command/tools/pip/ class=md-nav__link> tools-pip </a> </li> <li class=md-nav__item> <a href=../../command/tools/poetry/ class=md-nav__link> tools-poetry </a> </li> <li class=md-nav__item> <a href=../../command/tools/rg/ class=md-nav__link> tools-rg </a> </li> <li class=md-nav__item> <a href=../../command/tools/spotdl/ class=md-nav__link> tools-spotdl </a> </li> <li class=md-nav__item> <a href=../../command/tools/wkhtmltopdf/ class=md-nav__link> tools-wkhtmltopdf </a> </li> <li class=md-nav__item> <a href=../../command/tools/ydict/ class=md-nav__link> tools-ydict </a> </li> <li class=md-nav__item> <a href=../../command/tools/you-get/ class=md-nav__link> tools-you-get </a> </li> <li class=md-nav__item> <a href=../../command/tools/z/ class=md-nav__link> tools-z </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5_4 type=checkbox id=__nav_5_4 checked> <label class=md-nav__link for=__nav_5_4> digest <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=digest data-md-level=2> <label class=md-nav__title for=__nav_5_4> <span class="md-nav__icon md-icon"></span> digest </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../180719/ class=md-nav__link> 180719 </a> </li> <li class=md-nav__item> <a href=../1807200x01/ class=md-nav__link> 1807200x01 </a> </li> <li class=md-nav__item> <a href=../1807200x02/ class=md-nav__link> 1807200x02 </a> </li> <li class=md-nav__item> <a href=../180916/ class=md-nav__link> 180916 </a> </li> <li class=md-nav__item> <a href=../180919/ class=md-nav__link> 180919 </a> </li> <li class=md-nav__item> <a href=../180920/ class=md-nav__link> 180920 </a> </li> <li class=md-nav__item> <a href=../180921/ class=md-nav__link> 180921 </a> </li> <li class=md-nav__item> <a href=../1809270x01/ class=md-nav__link> 1809270x01 </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> 1809270x02 <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> 1809270x02 </a> <nav class="md-nav md-nav--secondary" aria-label=目录> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> 目录 </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#_1 class=md-nav__link> 内存模型到底是什么 </a> </li> <li class=md-nav__item> <a href=#jsr-133 class=md-nav__link> JSR 133讲了什么内容 </a> </li> <li class=md-nav__item> <a href=#jsr-133_1 class=md-nav__link> JSR 133的目标包括： </a> </li> <li class=md-nav__item> <a href=#_2 class=md-nav__link> 重排序的含义是什么？ </a> </li> <li class=md-nav__item> <a href=#_3 class=md-nav__link> 旧内存模型有什么问题？ </a> </li> <li class=md-nav__item> <a href=#_4 class=md-nav__link> 「非正确同步」是什么意思？ </a> </li> <li class=md-nav__item> <a href=#synchronization class=md-nav__link> Synchronization同步操作做了什么 </a> </li> <li class=md-nav__item> <a href=#_5 class=md-nav__link> 不可见变量如何看起来修改了它的值 </a> </li> <li class=md-nav__item> <a href=#final class=md-nav__link> 新的内存模型下final域的工作原理是怎样的？ </a> </li> <li class=md-nav__item> <a href=#volatile class=md-nav__link> volatile做了什么 </a> </li> <li class=md-nav__item> <a href=#_6 class=md-nav__link> 为什么要关心内存模型？ </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../181001/ class=md-nav__link> 181001 </a> </li> <li class=md-nav__item> <a href=../181004/ class=md-nav__link> 181004 </a> </li> <li class=md-nav__item> <a href=../181016/ class=md-nav__link> 181016 </a> </li> <li class=md-nav__item> <a href=../1902180x01/ class=md-nav__link> 1902180x01 </a> </li> <li class=md-nav__item> <a href=../1902180x02/ class=md-nav__link> 1902180x02 </a> </li> <li class=md-nav__item> <a href=../190606/ class=md-nav__link> 190606 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5_5 data-md-state=indeterminate type=checkbox id=__nav_5_5 checked> <label class=md-nav__link for=__nav_5_5> series <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=series data-md-level=2> <label class=md-nav__title for=__nav_5_5> <span class="md-nav__icon md-icon"></span> series </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../series/develop-mirror-cheatsheet/ class=md-nav__link> develop-mirror-cheatsheet </a> </li> <li class=md-nav__item> <a href=../../series/how-to-coffee/ class=md-nav__link> how-to-coffee </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5_6 data-md-state=indeterminate type=checkbox id=__nav_5_6 checked> <label class=md-nav__link for=__nav_5_6> snippets <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=snippets data-md-level=2> <label class=md-nav__title for=__nav_5_6> <span class="md-nav__icon md-icon"></span> snippets </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../snippets/abap/abap-gui-shortcuts/ class=md-nav__link> abap-abap-gui-shortcuts </a> </li> <li class=md-nav__item> <a href=../../snippets/emoji-snippets/ class=md-nav__link> emoji-snippets </a> </li> <li class=md-nav__item> <a href=../../snippets/others/cons-function/ class=md-nav__link> others-cons-function </a> </li> <li class=md-nav__item> <a href=../../snippets/others/function-prefix-words/ class=md-nav__link> others-function-prefix-words </a> </li> <li class=md-nav__item> <a href=../../snippets/others/markdown/ class=md-nav__link> others-markdown </a> </li> <li class=md-nav__item> <a href=../../snippets/others/regex/ class=md-nav__link> others-regex </a> </li> <li class=md-nav__item> <a href=../../snippets/others/test-if/ class=md-nav__link> others-test-if </a> </li> <li class=md-nav__item> <a href=../../snippets/others/xml/ class=md-nav__link> others-xml </a> </li> <li class=md-nav__item> <a href=../../snippets/python/pytest/ class=md-nav__link> python-pytest </a> </li> <li class=md-nav__item> <a href=../../snippets/python/python-builder/ class=md-nav__link> python-python-builder </a> </li> <li class=md-nav__item> <a href=../../snippets/python/python-decorator/ class=md-nav__link> python-python-decorator </a> </li> <li class=md-nav__item> <a href=../../snippets/python/python-http-request-soap-xml/ class=md-nav__link> python-python-http-request-soap-xml </a> </li> <li class=md-nav__item> <a href=../../snippets/python/python-logging/ class=md-nav__link> python-python-logging </a> </li> <li class=md-nav__item> <a href=../../snippets/python/python-mock/ class=md-nav__link> python-python-mock </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5_7 data-md-state=indeterminate type=checkbox id=__nav_5_7 checked> <label class=md-nav__link for=__nav_5_7> template <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=template data-md-level=2> <label class=md-nav__title for=__nav_5_7> <span class="md-nav__icon md-icon"></span> template </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../template/css/focus-cursor-move/ class=md-nav__link> css-focus-cursor-move </a> </li> <li class=md-nav__item> <a href=../../template/javascript/fibonacci/ class=md-nav__link> javascript-fibonacci </a> </li> <li class=md-nav__item> <a href=../../template/javascript/jquery/ class=md-nav__link> javascript-jquery </a> </li> <li class=md-nav__item> <a href=../../template/javascript/trim/ class=md-nav__link> javascript-trim </a> </li> <li class=md-nav__item> <a href=../../template/javascript/url/ class=md-nav__link> javascript-url </a> </li> <li class=md-nav__item> <a href=../../template/javascript/uuid/ class=md-nav__link> javascript-uuid </a> </li> <li class=md-nav__item> <a href=../../template/javascript/voice/ class=md-nav__link> javascript-voice </a> </li> <li class=md-nav__item> <a href=../../template/sql/get-data-table-create-structure/ class=md-nav__link> sql-get-data-table-create-structure </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5_8 data-md-state=indeterminate type=checkbox id=__nav_5_8 checked> <label class=md-nav__link for=__nav_5_8> via <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=via data-md-level=2> <label class=md-nav__title for=__nav_5_8> <span class="md-nav__icon md-icon"></span> via </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../via/LGTM/ class=md-nav__link> LGTM </a> </li> <li class=md-nav__item> <a href=../../via/bilibili-rex/ class=md-nav__link> bilibili-rex </a> </li> <li class=md-nav__item> <a href=../../via/get_m3u8/ class=md-nav__link> get_m3u8 </a> </li> <li class=md-nav__item> <a href=../../via/github_check/ class=md-nav__link> github_check </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_6 data-md-state=indeterminate type=checkbox id=__nav_6 checked> <label class=md-nav__link for=__nav_6> about <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=about data-md-level=1> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> about </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../cheatsheet/ class=md-nav__link> cheatsheet </a> </li> <li class=md-nav__item> <a href=../../words/ class=md-nav__link> docs-words </a> </li> <li class=md-nav__item> <a href=../../.. class=md-nav__link> index </a> </li> <li class=md-nav__item> <a href=../../../what-i-use/ class=md-nav__link> what-i-use </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_7 data-md-state=indeterminate type=checkbox id=__nav_7 checked> <label class=md-nav__link for=__nav_7> weekly <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=weekly data-md-level=1> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> weekly </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../weekly/weekly-2021-04-0x01/ class=md-nav__link> Weekly 2021-04-0x01 </a> </li> <li class=md-nav__item> <a href=../../../weekly/weekly-2021-04-0x02/ class=md-nav__link> Weekly 2021-04-0x02 </a> </li> <li class=md-nav__item> <a href=../../../weekly/weekly-2021-06-0x01/ class=md-nav__link> Weekly 2021-06-0x01 </a> </li> <li class=md-nav__item> <a href=../../../weekly/weekly-2021-06-0x02/ class=md-nav__link> Weekly 2021-06-0x02 </a> </li> <li class=md-nav__item> <a href=../../../weekly/weekly-2021-07-0x01/ class=md-nav__link> Weekly 2021-07-0x01 </a> </li> <li class=md-nav__item> <a href=../../../weekly/weekly-2020-10-0x01/ class=md-nav__link> weekly-2020-10-0x01 </a> </li> <li class=md-nav__item> <a href=../../../weekly/weekly-2020-10-0x02/ class=md-nav__link> weekly-2020-10-0x02 </a> </li> <li class=md-nav__item> <a href=../../../weekly/weekly-2020-11-0x01/ class=md-nav__link> weekly-2020-11-0x01 </a> </li> <li class=md-nav__item> <a href=../../../weekly/weekly-2020-11-0x02/ class=md-nav__link> weekly-2020-11-0x02 </a> </li> <li class=md-nav__item> <a href=../../../weekly/weekly-2020-11-0x03/ class=md-nav__link> weekly-2020-11-0x03 </a> </li> <li class=md-nav__item> <a href=../../../weekly/weekly-2020-11-0x04/ class=md-nav__link> weekly-2020-11-0x04 </a> </li> <li class=md-nav__item> <a href=../../../weekly/weekly-2020-12-0x01/ class=md-nav__link> weekly-2020-12-0x01 </a> </li> <li class=md-nav__item> <a href=../../../weekly/weekly-2020-12-0x02/ class=md-nav__link> weekly-2020-12-0x02 </a> </li> <li class=md-nav__item> <a href=../../../weekly/weekly-2020-12-0x03/ class=md-nav__link> weekly-2020-12-0x03 </a> </li> <li class=md-nav__item> <a href=../../../weekly/weekly-2021-01-0x01/ class=md-nav__link> weekly-2021-01-0x01 </a> </li> <li class=md-nav__item> <a href=../../../weekly/weekly-2021-01-0x02/ class=md-nav__link> weekly-2021-01-0x02 </a> </li> <li class=md-nav__item> <a href=../../../weekly/weekly-2021-02-0x01/ class=md-nav__link> weekly-2021-02-0x01 </a> </li> <li class=md-nav__item> <a href=../../../weekly/weekly-2021-02-0x02/ class=md-nav__link> weekly-2021-02-0x02 </a> </li> <li class=md-nav__item> <a href=../../../weekly/weekly-2021-02-0x03/ class=md-nav__link> weekly-2021-02-0x03 </a> </li> <li class=md-nav__item> <a href=../../../weekly/weekly-2021-02-0x04/ class=md-nav__link> weekly-2021-02-0x04 </a> </li> <li class=md-nav__item> <a href=../../../weekly/weekly-2021-03-0x01/ class=md-nav__link> weekly-2021-03-0x01 </a> </li> <li class=md-nav__item> <a href=../../../weekly/weekly-2021-03-0x02/ class=md-nav__link> weekly-2021-03-0x02 </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label=目录> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> 目录 </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#_1 class=md-nav__link> 内存模型到底是什么 </a> </li> <li class=md-nav__item> <a href=#jsr-133 class=md-nav__link> JSR 133讲了什么内容 </a> </li> <li class=md-nav__item> <a href=#jsr-133_1 class=md-nav__link> JSR 133的目标包括： </a> </li> <li class=md-nav__item> <a href=#_2 class=md-nav__link> 重排序的含义是什么？ </a> </li> <li class=md-nav__item> <a href=#_3 class=md-nav__link> 旧内存模型有什么问题？ </a> </li> <li class=md-nav__item> <a href=#_4 class=md-nav__link> 「非正确同步」是什么意思？ </a> </li> <li class=md-nav__item> <a href=#synchronization class=md-nav__link> Synchronization同步操作做了什么 </a> </li> <li class=md-nav__item> <a href=#_5 class=md-nav__link> 不可见变量如何看起来修改了它的值 </a> </li> <li class=md-nav__item> <a href=#final class=md-nav__link> 新的内存模型下final域的工作原理是怎样的？ </a> </li> <li class=md-nav__item> <a href=#volatile class=md-nav__link> volatile做了什么 </a> </li> <li class=md-nav__item> <a href=#_6 class=md-nav__link> 为什么要关心内存模型？ </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/HackettYu/hackettyu-mkdocs-material/blob/master/docs/docs/digest/1809270x02.md title=编辑此页 class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg> </a> <h1>1809270x02</h1> <blockquote> <p><a href=https://xurongyang.github.io/2017/05/20/JSR-133-FAQ%E7%BF%BB%E8%AF%91/ >https://xurongyang.github.io/2017/05/20/JSR-133-FAQ%E7%BF%BB%E8%AF%91/</a> <a href=https://www.cs.umd.edu/~pugh/java/memoryModel/jsr-133-faq.html>https://www.cs.umd.edu/~pugh/java/memoryModel/jsr-133-faq.html</a></p> </blockquote> <h2 id=_1>内存模型到底是什么<a class=headerlink href=#_1 title="Permanent link">&para;</a></h2> <p>在多处理器计算机系统中，处理器一般拥有多层次的内存缓存，内存缓存一方面能够提高访问数据的速度（因为数据离处理器更近了），另一方面能降低总线的流量（因为许多内存操作可以被缓存替代）。内存缓存能极大的提高性能，但是也带来了一些挑战。例如，当两个处理器同时访问同一个内存地址时会发生什么事情？在什么情况下他们能看到相同的值？</p> <p>在处理器级别，存储器模型定义了必要和充分的条件，用于知道其他处理器对存储器的写入对于当前处理器是可见的，并且当前处理器的写入对于其他处理器是可见的。一些处理器应用了强一致内存模型，所有的处理器对于同一个内存地址，看到的值都是一样的。其它一些处理器应用了弱一些的内存模型，利用内存屏障来刷新处理器本地缓存，这样处理器就能看到其它处理器的写操作的结果。这些内存屏障通常在lock和unlock操作时执行，它们对于高级程序设计语言是透明的。</p> <p>在强一致内存模型下编写程序通常更为容易，因为不需要用到内存屏障。然而，即使是一致性最强的内存模型也经常会用到内存屏障。往往他们的位置都是违反直觉的。处理器设计的最新趋势鼓励了较弱的内存模型，因为它们对缓存一致性的放宽使得可以在多个处理器和更大量的内存中实现更大的可扩展性。</p> <p>一个写入操作什么时间对另外一个线程可见的问题部分是由编译器重排序导致的。例如，编译器可能会决定把一个写入操作推迟执行会更加高效。只有不改变程序的语义即可。如果编译器推迟了一个操作，另一个线程直到它真正执行后才会看到操作结果，这反应了缓存的效果（最后半句有点奇怪）。</p> <p>此外，写操作也可能会提前，在这种情况下，其它线程可能会提前看到一个写操作发生。所有这些都是特意设计的 - 通过给编译器，运行时或硬件提供灵活性，以最佳顺序在内存模型的范围内执行操作，我们可以实现更高的性能。</p> <p>举一个简单的例子： <div class=highlight><pre><span></span><code><span class=n>Class</span> <span class=n>Reordering</span> <span class=p>{</span>
  <span class=kt>int</span> <span class=n>x</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
  <span class=kd>public</span> <span class=kt>void</span> <span class=nf>writer</span><span class=p>()</span> <span class=p>{</span>
    <span class=n>x</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
    <span class=n>y</span> <span class=o>=</span> <span class=mi>2</span><span class=p>;</span>
  <span class=p>}</span>
  <span class=kd>public</span> <span class=kt>void</span> <span class=nf>reader</span><span class=p>()</span> <span class=p>{</span>
    <span class=kt>int</span> <span class=n>r1</span> <span class=o>=</span> <span class=n>y</span><span class=p>;</span>
    <span class=kt>int</span> <span class=n>r2</span> <span class=o>=</span> <span class=n>x</span><span class=p>;</span>
  <span class=p>}</span>
<span class=p>}</span>
</code></pre></div> 假设这段代码被两个线程并发执行，并且y读取到的值是2。因为y的写入在x之后，所以程序员可能会认为x的值必定是1。然而，写操作可能被重排序了，如果发生这种情况，可能会先写入y，然后发生两个变量的读取，最后写入x。 结果是r1的值为2，但r2的值为0。</p> <p>Java内存模型描述了多线程代码中的哪些行为是合法的，以及线程如何通过内存进行交互。 它描述了程序中变量之间的关系以及在实际计算机系统中存储和检索内存或寄存器的底层细节。 它可以使用各种各样的硬件和各种编译器优化来正确实现。</p> <p>Java包括几种语言结构，包括volatile，final和synchronized，它们旨在帮助程序员将程序的并发要求提供给编译器。 Java内存模型定义了volatile和synchronized的行为，更重要的是确保正确同步的Java程序在所有处理器架构上正确运行。</p> <p>其它语言有没有内存模型 大多数其他编程语言（如C和C ++）并没有直接支持多线程。 这些语言抑制编译器和体系结构中的重排序提供给程序员的保护在很大程度上取决于所使用的线程库（例如pthreads），使用的编译器以及运行代码的平台提供的保证。</p> <h2 id=jsr-133>JSR 133讲了什么内容<a class=headerlink href=#jsr-133 title="Permanent link">&para;</a></h2> <p>自1997年以来，在Java语言规范第17章定义的Java Memory Model中发现了几个严重的缺陷。 这些缺陷允许混淆行为（例如观察到final改变了其值），并且破坏了编译器执行常见优化的能力。</p> <p>Java内存模型是一项雄心勃勃的工作; 这是第一次编程语言规范试图并入一个内存模型，可以为各种架构的并发提供一致的语义。 不幸的是，定义一个一致和直观的记忆模型比预期的困难得多。 JSR 133定义了一种用于Java语言的新内存模型，它修复了较早内存模型的缺陷。 为了做到这一点，final和volatile的语义需要改变。</p> <p>完整内容可以在 <a href=http://www.cs.umd.edu/users/pugh/java/memoryModel>The Java Memory Model</a> 找到，but the formal semantics are not for the timid（这句不懂）.It is surprising, and sobering, to discover how complicated seemingly simple concepts like synchronization really are（这句也是）.幸运的是，你不需要了解正式语义的细节 - JSR 133的目标是创建一套语义，为volatile，synchronized和final提供了一个直观的框架。</p> <h2 id=jsr-133_1>JSR 133的目标包括：<a class=headerlink href=#jsr-133_1 title="Permanent link">&para;</a></h2> <ul> <li>保持现有的安全保障，如类型安全，加强其他。 例如，变量值可能不会被创建为某个没有赋值给它的值：由某个线程观察到的变量的每个值必须是由某个线程设置过的值。</li> <li>正确同步程序的语义应尽可能简单直观。</li> <li>应该定义不完整或不正确同步的程序的语义，以使潜在的安全隐患最小化。（不懂）</li> <li>程序员应该能够自信地说明多线程程序如何与内存交互。</li> <li>应该可以在广泛的流行硬件架构中设计正确的，高性能的JVM实现。</li> <li>应提供初始化安全的新保证。 如果对象被正确构造（这意味着在构造过程中它的引用不会逸出），那么可以看到对该对象的引用的所有线程也将看到在构造函数中设置的final域的值，而不需要同步。</li> <li>对已存在的代码有很小的影响</li> </ul> <h2 id=_2>重排序的含义是什么？<a class=headerlink href=#_2 title="Permanent link">&para;</a></h2> <p>有许多情况下，程序变量（对象实例字段，类静态字段和数组元素）的访问可能会以与程序指定的不同的顺序执行。 编译器可以按照优化的名义，对指令进行重排序。 数据可以在寄存器，处理器高速缓存和主存储器之间以与程序指定的顺序不同的顺序移动。</p> <p>例如，如果线程先写入字段a，然后写入字段b，并且b的值不依赖于a的值，则编译器可以自由地对这些操作进行重新排序，并且缓存可以自由地刷新b的值到内存，在a之前。 有一些潜在的重新排序来源，如编译器，JIT和缓存。</p> <p>编译器，运行时和硬件会创造一个as-if-serial语义的错觉，这意味着在一个单线程程序中，该程序不应该能够观察到重排序的影响。 然而，重排序可能会在不正确同步的多线程程序中发挥作用，其中一个线程能够观察到其他线程的影响，并且可能能够检测到该变量访问以与代码顺序不同的方式显示给其他线程。</p> <p>大多数时候，一个线程不在乎其它线程在做什么。 但是，如果它在乎，就需要用到同步。</p> <h2 id=_3>旧内存模型有什么问题？<a class=headerlink href=#_3 title="Permanent link">&para;</a></h2> <p>旧的内存模型有几个严重的问题。它很难理解，因此被广泛的违背。例如，旧的内存模型在很多情况下都没有允许在大多数JVM中应用的重排序措施。这带来了JSR 133的形成。</p> <p>例如，一个广泛认同的观点是，如果使用final，则线程之间的同步是不必要的，以保证另一个线程将看到该字段的值。 虽然这是一个合理的假设和一个明智的行为，实际上我们想要的东西如何工作，在旧的记忆模式下，根本不是这么做的。 旧的内存模型中没有任何内容表明它处理final字段与任何其他字段不同 - 意思是同步是确保所有线程都看到由构造函数编写的最终字段的值的唯一方法。 因此，线程可能会看到该字段的默认值，然后在稍后的时间内看到其构造的值。 这意味着，例如，像String这样的不可变对象似乎可以改变它们的值 - 这是一个令人不安的现象。</p> <p>旧的内存模型允许volatile与非volatile的读写操作进行重排序，这与大多数开发人员对volatile的直觉不一致，从而导致混乱。</p> <p>最后，正如我们将看到的那样，程序员对程序错误同步时可能会发生什么的直觉通常是错误的。 JSR-133的目标之一是提请注意到这一事实。</p> <h2 id=_4>「非正确同步」是什么意思？<a class=headerlink href=#_4 title="Permanent link">&para;</a></h2> <p>不正确同步的代码对于不同人的含义不一样。 当我们谈到在Java内存模型的上下文中错误地同步的代码时，我们的意思是任何代码</p> <p>有一个线程写入一个变量 有另一个线程读取相同的变量 写入和读取没有用同步操作来排序 当这些规则被违反时，我们说我们在这个变量上有一个数据竞争。 具有数据竞争的程序是一个不正确同步的程序。</p> <h2 id=synchronization>Synchronization同步操作做了什么<a class=headerlink href=#synchronization title="Permanent link">&para;</a></h2> <p>同步有几个方面。 最容易理解的是互斥 - 只有一个线程可以拿到一个监视器锁，因此在监视器锁上同步意味着一旦一个线程进入被监视器锁保护的同步块，则没有其他线程可以进入该监视器锁保护的块，直到第一个线程退出同步块。</p> <p>但是不仅仅是互斥访问，Synchronization同步确保在同步块之前或期间，线程的内存写入以可预测的方式显示给同一监视器上同步的其他线程。 在我们退出同步程序段后，我们释放监视器锁，该监视器锁具有将缓存刷新到内存的作用，使得此线程所做的写入对其他线程可见。 在我们可以进入同步块之前，我们需要获取监视器锁，该监视器锁具有使本地处理器缓存无效的效果，以便从内存重新加载变量。 然后，我们将能够看到所有的上一版本都可以看到的写入。</p> <p>在缓存方面进行讨论，可能听起来好像这些问题只影响多处理器机器。 然而，可以在单个处理器上轻松看到重新排序的效果。 例如，编译器不会将acquire之后的代码移动到它之前，也不会把release之前的代码移动到它之后。当我们说acquire和release对缓存的操作时，我们忽略了很多的细节内容。</p> <p>新的内存模型语义在内存操作（读取字段，写入字段，加锁，解锁）和其他线程操作（启动和连接）上创建了一些偏序规则，其中一些操作在其他操作之前发生。 当一个动作发生在另一个动作之前，第一个被保证在第二个之前被执行并且结果对其可见。 此排序的规则如下：</p> <ul> <li>单线程中是完全按照代码顺序执行的</li> <li>监视器的解锁操作发生在该监视器随后的加锁操作之前</li> <li>对volatile字段的写入发生在该volatile字段每次后续读取之前</li> <li>线程的start操作发生于该线程内的任何一行代码之前</li> <li>一个线程内的所有操作都发生在join了这个线程的线程之前 这意味着一个线程在退出同步块之前的所有内存操作对于任何其它进入该同步块的线程都是可见的，因为所有的内存操作都发生在release之前，release发生在acquire之前。</li> </ul> <p>另外一个含义是，下面的这个被许多人用作内存屏障的操作不起作用： <div class=highlight><pre><span></span><code><span class=kd>synchronized</span> <span class=p>(</span><span class=k>new</span> <span class=n>Object</span><span class=p>())</span> <span class=p>{}</span>
</code></pre></div> 这实际上没有任何效果，你的编译器可以完全删除它，因为编译器知道没有其他线程将在同一个监视器上同步。如果一个线程想看到另外一个线程的结果，就必须设置一个happens before规则。</p> <p>重要提示：两个线程必须在同一个监视器锁上进行同步，这样才能设置happens before规则。如果线程A在X上同步，线程B在Y上同步，这样是没有效果的。release和acquire必须匹配，否则会存在数据竞争的问题。</p> <h2 id=_5>不可见变量如何看起来修改了它的值<a class=headerlink href=#_5 title="Permanent link">&para;</a></h2> <p>最好的例子是String类的一个实现。</p> <p>字符串可以实现为具有三个字段的对象 - 字符数组，该数组中的偏移量和长度。 以这种方式实现String的理由，而不是仅使用字符数组，它允许多个String和StringBuffer对象共享相同的字符数组，并避免额外的对象分配和复制。 所以，例如，String.substring（）方法可以通过创建一个新的字符串来实现，该字符串与原始的String共享相同的字符数组，并且在长度和偏移量字段中只是不同。 对于字符串，这些字段都是final字段。 <div class=highlight><pre><span></span><code><span class=n>String</span> <span class=n>s1</span> <span class=o>=</span> <span class=s>&quot;/usr/tmp&quot;</span><span class=p>;</span>
<span class=n>String</span> <span class=n>s2</span> <span class=o>=</span> <span class=n>s1</span><span class=p>.</span><span class=na>substring</span><span class=p>(</span><span class=mi>4</span><span class=p>);</span>
</code></pre></div> 字符串s2的偏移量为4，长度为4.但是，在旧内存模型下，另一个线程可以将偏移量看作默认值为0，然后看到正确的值为4， 它将显示为字符串「/usr」更改为「/tmp」。</p> <p>旧内存模型允许这种行为，几个JVM禁止了这些行为，在新的内存模型下，这种行为是违法的。</p> <h2 id=final>新的内存模型下final域的工作原理是怎样的？<a class=headerlink href=#final title="Permanent link">&para;</a></h2> <p>对象的final字段的值在其构造函数中设置。假设对象被正确构造，一旦构造完成，在构造函数中分配的final字段的值将对所有其他线程都是可见的，不需要同步。 此外，final字段引用的任何其他对象或数组的值将与final字段保持同步更新。</p> <p>对象被正确构造是什么意思？ 这仅仅意味着在构造过程中，不允许正在构造的对象的引用「逃脱」。 （参见安全构造技术的例子）换句话说，不要对正在构造的对象引用另外一个线程可能看到的对象; 不要将其分配给静态字段，不要将其注册为与任何其他对象的监听器，等等。 这些任务应该在构造函数完成之后完成，而不是在构造函数中完成。 <div class=highlight><pre><span></span><code><span class=kd>class</span> <span class=nc>FinalFieldExample</span> <span class=p>{</span>
  <span class=kd>final</span> <span class=kt>int</span> <span class=n>x</span><span class=p>;</span>
  <span class=kt>int</span> <span class=n>y</span><span class=p>;</span>
  <span class=kd>static</span> <span class=n>FinalFieldExample</span> <span class=n>f</span><span class=p>;</span>
  <span class=kd>public</span> <span class=nf>FinalFieldExample</span><span class=p>()</span> <span class=p>{</span>
    <span class=n>x</span> <span class=o>=</span> <span class=mi>3</span><span class=p>;</span>
    <span class=n>y</span> <span class=o>=</span> <span class=mi>4</span><span class=p>;</span>
  <span class=p>}</span>
  <span class=kd>static</span> <span class=kt>void</span> <span class=nf>writer</span><span class=p>()</span> <span class=p>{</span>
    <span class=n>f</span> <span class=o>=</span> <span class=k>new</span> <span class=n>FinalFieldExample</span><span class=p>();</span>
  <span class=p>}</span>
  <span class=kd>static</span> <span class=kt>void</span> <span class=nf>reader</span><span class=p>()</span> <span class=p>{</span>
    <span class=k>if</span> <span class=p>(</span><span class=n>f</span> <span class=o>!=</span> <span class=kc>null</span><span class=p>)</span> <span class=p>{</span>
      <span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>f</span><span class=p>.</span><span class=na>x</span><span class=p>;</span>
      <span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=n>f</span><span class=p>.</span><span class=na>y</span><span class=p>;</span>
    <span class=p>}</span>
  <span class=p>}</span>
<span class=p>}</span>
</code></pre></div> 上面的类是一个使用final字段的例子。 线程执行reader保证为f.x看到值3，因为它是final的。不能保证为y看到值4，因为它不是final的。 如果FinalFieldExample的构造函数如下所示： <div class=highlight><pre><span></span><code><span class=kd>public</span> <span class=nf>FinalFieldExample</span><span class=p>()</span> <span class=p>{</span> <span class=c1>// bad!</span>
  <span class=n>x</span> <span class=o>=</span> <span class=mi>3</span><span class=p>;</span>
  <span class=n>y</span> <span class=o>=</span> <span class=mi>4</span><span class=p>;</span>
  <span class=c1>// bad construction - allowing this to escape</span>
  <span class=n>global</span><span class=p>.</span><span class=na>obj</span> <span class=o>=</span> <span class=k>this</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div> 那么从<code>global.obj</code>读取this的线程不能保证为x看到3。</p> <p>能看到正确构造的字段值的能力是很好的，但是如果字段本身是引用，那么你还希望你的代码可以看到它指向的对象（或数组）的最新值。 如果你的领域是一个final域，这也是保证的。 所以，你可以有一个final指向数组的指针，而不用担心其他线程看到数组的引用是正确的，但数组的内容不正确。Again, by 「correct」 here, we mean 「up to date as of the end of the object’s constructor」, not 「the latest value available」.</p> <p>现在，说完所有这一切，如果在一个线程构造一个不可变对象（即只包含final字段的对象）之后，你想要确保所有其他线程都能看到正确的值，你通常还需要使用同步。 没有其他方法来确保，例如，第二个线程将会看到对不可变对象的引用。程序从final字段获得的保证应该非常小心，深入细心地了解如何在代码中管理并发性。</p> <p>用JNI修改final字段的值，这样的行为没有具体定义。</p> <h2 id=volatile>volatile做了什么<a class=headerlink href=#volatile title="Permanent link">&para;</a></h2> <p>volatile字段是用于在线程之间通信状态的特殊字段。每个读取的volatile的线程都会看到最后写入volatile的值; 实际上，它们被程序员设计为不会因为缓存或者重排序看不到最新的值的字段。禁止编译器和运行时环境在寄存器中分配volatile变量。 他们还必须确保在写入之后，将它们从缓存中刷新到内存，以便它们可以立即变得对其他线程可见。 类似地，在读取volatile字段之前，缓存必须被设置为无效，使得内存（而不是本地处理器高速缓存）中的值是最新的值。对volatile变量的访问重新排序也有其他限制。</p> <p>在旧的内存模型下，volatile变量之间是不可以重排序的，但是和普通变量之间是可以重排序的，这破坏了volatile对于线程间传递信号的有用性。</p> <p>在新的内存模型下，volatile变量之间还是不可以重排序，但是和普通变量之间也不可以重排序了。写入volatile的值和释放synchronized锁的内存效果是一样的，读取volatile的值和synchronized加锁的内存效果是一样的。实际上，因为新的存储器模型对于其他字段和volatile字段的重排序进行了更加严格的约束，无论是不是volatile变量，线程A在写入volatile字段f时可见的任何东西对于线程B在读取f时都是可见的。</p> <p>下面是使用volatile的一个例子： <div class=highlight><pre><span></span><code><span class=kd>class</span> <span class=nc>VolatileExample</span> <span class=p>{</span>
  <span class=kt>int</span> <span class=n>x</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
  <span class=kd>volatile</span> <span class=kt>boolean</span> <span class=n>v</span> <span class=o>=</span> <span class=kc>false</span><span class=p>;</span>
  <span class=kd>public</span> <span class=kt>void</span> <span class=nf>writer</span><span class=p>()</span> <span class=p>{</span>
    <span class=n>x</span> <span class=o>=</span> <span class=mi>42</span><span class=p>;</span>
    <span class=n>v</span> <span class=o>=</span> <span class=kc>true</span><span class=p>;</span>
  <span class=p>}</span>
  <span class=kd>public</span> <span class=kt>void</span> <span class=nf>reader</span><span class=p>()</span> <span class=p>{</span>
    <span class=k>if</span> <span class=p>(</span><span class=n>v</span> <span class=o>==</span> <span class=kc>true</span><span class=p>)</span> <span class=p>{</span>
      <span class=c1>//uses x - guaranteed to see 42.</span>
    <span class=p>}</span>
  <span class=p>}</span>
<span class=p>}</span>
</code></pre></div> 假设一个线程正在调用writer，另一个线程是调用reader。 对v的写入器会把x的值写入到内存，并且v从内存中获取该值。 因此，如果读者看到v的值为true，那么也可以保证看到之前发生的写入42。 在旧的记忆模型下不是这样。 如果v不是volatile的，那么编译器可以对写入器中的写入进行重新排序，读者对x的读取可能会看到0。</p> <p>volatile的语义被大大加强，几乎到达了synchronized的水平。对于可见性来说，volatile操作几乎和synchronized一样。</p> <p>重要提示：和synchronized一样，必须用同一个volatile才能保证可见性。</p> <p>新的内存模型是否修复了「双重锁定」问题？ （臭名昭着的）双重检查锁定成语（也称为多线程单例模式）是一种技巧，旨在支持延迟初始化，同时避免同步的开销。在非常早期的JVM中，同步非常缓慢，开发人员急于删除它 - 也许太渴望了。双重锁定的模式如下所示： <div class=highlight><pre><span></span><code><span class=c1>// double-checked-locking - don&#39;t do this!</span>
<span class=kd>private</span> <span class=kd>static</span> <span class=n>Something</span> <span class=n>instance</span> <span class=o>=</span> <span class=kc>null</span><span class=p>;</span>
<span class=kd>public</span> <span class=n>Something</span> <span class=nf>getInstance</span><span class=p>()</span> <span class=p>{</span>
  <span class=k>if</span> <span class=p>(</span><span class=n>instance</span> <span class=o>==</span> <span class=kc>null</span><span class=p>)</span> <span class=p>{</span>
    <span class=kd>synchronized</span> <span class=p>(</span><span class=k>this</span><span class=p>)</span> <span class=p>{</span>
      <span class=k>if</span> <span class=p>(</span><span class=n>instance</span> <span class=o>==</span> <span class=kc>null</span><span class=p>)</span>
        <span class=n>instance</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Something</span><span class=p>();</span>
    <span class=p>}</span>
  <span class=p>}</span>
  <span class=k>return</span> <span class=n>instance</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div> 这看起来很聪明 - 在公共代码路径上避免了同步。 它只有一个问题 - 它没有作用。为什么没有作用？最明显的原因是初始化实例和对实例字段的写入可以由编译器或缓存重新排序，这将具有返回看起来是部分构造的对象的效果。 结果将是我们读取一个未初始化的对象。 还有很多其他原因能说明为什么这是错误的。没有办法使用旧的Java内存模型进行修复。更多信息可以查看：Double-checked locking: Clever, but broken和The 「Double Checked Locking is broken」 declaration</p> <p>许多人认为使用volatile关键字会消除在尝试使用双重检查锁定模式时出现的问题。 在1.5之前的JVM中，volatile不会确保它有效。 在新的内存模型下，使实例字段volatile将「修复」双重锁定的问题，因为在构造和读取之间存在happens before关系。</p> <p>用另外一种方式更好： <div class=highlight><pre><span></span><code><span class=kd>private</span> <span class=kd>static</span> <span class=kd>class</span> <span class=nc>LazySomethingHolder</span> <span class=p>{</span>
  <span class=kd>public</span> <span class=kd>static</span> <span class=n>Something</span> <span class=n>something</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Something</span><span class=p>();</span>
<span class=p>}</span>
<span class=kd>public</span> <span class=kd>static</span> <span class=n>Something</span> <span class=nf>getInstance</span><span class=p>()</span> <span class=p>{</span>
  <span class=k>return</span> <span class=n>LazySomethingHolder</span><span class=p>.</span><span class=na>something</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div> 由于静态字段的初始化保证，该代码保证是正确的; 如果在静态初始化程序中设置了一个字段，那么它将被保证被正确地显示给访问该类的任何线程。</p> <p>对虚拟机从业者 你应该看 <a href=http://gee.cs.oswego.edu/dl/jmm/cookbook.html>The JSR-133 Cookbook for Compiler Writers</a></p> <h2 id=_6>为什么要关心内存模型？<a class=headerlink href=#_6 title="Permanent link">&para;</a></h2> <p>你为什么要关心？ 并发错误很难调试。他们经常不出现在测试中，需要等待，直到你的程序在高负载下运行，并且难以重现。 你最好提前花费额外的努力，以确保您的程序正确同步; 虽然这不容易，但比尝试调试严重同步的应用程序要容易得多。</p> <hr> <div class=md-source-date> <small> 最后更新: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2021-07-11</span> <br>创建日期: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2021-03-02</span> </small> </div> </article> </div> </div> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../1809270x01/ class="md-footer__link md-footer__link--prev" aria-label="上一页: 1809270x01" rel=prev> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </div> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> 上一页 </span> 1809270x01 </div> </div> </a> <a href=../181001/ class="md-footer__link md-footer__link--next" aria-label="下一页: 181001" rel=next> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> 下一页 </span> 181001 </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> <div class=md-footer-copyright__highlight> Copyright &copy; 2018 - 2021 </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-footer-social> <a href=https://github.com/hackettyu target=_blank rel=noopener title=github.com class=md-footer-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </a> <a href=https://twitter.com/HackettYu target=_blank rel=noopener title=twitter.com class=md-footer-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg> </a> <a href=spotify:user:12glou9s4691jdz6arkbb8zmn target=_blank rel=noopener title class=md-footer-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><path d="M248 8C111.1 8 0 119.1 0 256s111.1 248 248 248 248-111.1 248-248S384.9 8 248 8zm100.7 364.9c-4.2 0-6.8-1.3-10.7-3.6-62.4-37.6-135-39.2-206.7-24.5-3.9 1-9 2.6-11.9 2.6-9.7 0-15.8-7.7-15.8-15.8 0-10.3 6.1-15.2 13.6-16.8 81.9-18.1 165.6-16.5 237 26.2 6.1 3.9 9.7 7.4 9.7 16.5s-7.1 15.4-15.2 15.4zm26.9-65.6c-5.2 0-8.7-2.3-12.3-4.2-62.5-37-155.7-51.9-238.6-29.4-4.8 1.3-7.4 2.6-11.9 2.6-10.7 0-19.4-8.7-19.4-19.4s5.2-17.8 15.5-20.7c27.8-7.8 56.2-13.6 97.8-13.6 64.9 0 127.6 16.1 177 45.5 8.1 4.8 11.3 11 11.3 19.7-.1 10.8-8.5 19.5-19.4 19.5zm31-76.2c-5.2 0-8.4-1.3-12.9-3.9-71.2-42.5-198.5-52.7-280.9-29.7-3.6 1-8.1 2.6-12.9 2.6-13.2 0-23.3-10.3-23.3-23.6 0-13.6 8.4-21.3 17.4-23.9 35.2-10.3 74.6-15.2 117.5-15.2 73 0 149.5 15.2 205.4 47.8 7.8 4.5 12.9 10.7 12.9 22.6 0 13.6-11 23.3-23.2 23.3z"/></svg> </a> <a href=https://hackettyu.com/todo target=_blank rel=noopener title=hackettyu.com class=md-footer-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M128.081 415.959c0 35.369-28.672 64.041-64.041 64.041S0 451.328 0 415.959s28.672-64.041 64.041-64.041 64.04 28.673 64.04 64.041zm175.66 47.25c-8.354-154.6-132.185-278.587-286.95-286.95C7.656 175.765 0 183.105 0 192.253v48.069c0 8.415 6.49 15.472 14.887 16.018 111.832 7.284 201.473 96.702 208.772 208.772.547 8.397 7.604 14.887 16.018 14.887h48.069c9.149.001 16.489-7.655 15.995-16.79zm144.249.288C439.596 229.677 251.465 40.445 16.503 32.01 7.473 31.686 0 38.981 0 48.016v48.068c0 8.625 6.835 15.645 15.453 15.999 191.179 7.839 344.627 161.316 352.465 352.465.353 8.618 7.373 15.453 15.999 15.453h48.068c9.034-.001 16.329-7.474 16.005-16.504z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../..", "features": ["tabs", "navigation.tabs", "navigation.instant", "navigation.sections", "navigation.expand"], "translations": {"clipboard.copy": "\u590d\u5236", "clipboard.copied": "\u5df2\u590d\u5236", "search.config.lang": "ja", "search.config.pipeline": "trimmer, stemmer", "search.config.separator": "[\\uff0c\\u3002]+", "search.placeholder": "\u641c\u7d22", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../../assets/javascripts/workers/search.477d984a.min.js", "version": null}</script> <script src=../../../assets/javascripts/bundle.ddd52ceb.min.js></script> <script src=/js/termynal.js></script> <script src=/js/custom.js></script> </body> </html>